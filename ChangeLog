2003-04-18  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* lib/am/dejagnu.am (site.exp): Don't define tool in site.exp,
	because we set that by invoking runtest with --tool.
	* tests/Makefile.am (TESTS): Add dejagnu4.test, dejagnu5.test,
	dejagnu6.test, dejagnu7.test.
	* tests/dejagnu4.test: New test.
	* tests/dejagnu5.test: New test.
	* tests/dejagnu6.test: New test.
	* tests/dejagnu7.test: New test.

	* tests/dejagnu3.test: Make sure the DejaGnu test is actually run.
	
2003-04-18  Jim Meyering  <jim@meyering.net>

	* lib/am/yacc.am (?!GENERIC?%OBJ% aka .y.c): Don't redirect
	directly to $@.  Instead, redirect to $@t and rename upon success.
	Also, move the commands that update $@ so they are last.  Otherwise,
	this rule could leave the user with an up to date target (.c file)
	but with a missing or corrupted corresponding .h file.

2003-04-17  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* tests/defs.in: Handle required=runtest, to detect runtest
	from DejaGnu.
	* tests/Makefile.am (TESTS): Add dejagnu3.test.
	* tests/dejagnu3.test: New test.

2003-04-16  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (rule_define): If the user tries to override
	an Automake which has a -local variant, suggest using the
	-local variant in the -Woverride diagnostic.
	(handle_factored_dependencies): Register factored
	rules with rule_define, and define them only in undefined
	conditions.
	* tests/Makefile.am (TESTS): Add override.test.
	* tests/overrid.test: New file.
	* tests/phony.test: Count the number of .PHONY targets.

2003-04-15  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/distdir.am (distuninstallcheck, distcleancheck): Silence
	these rules, so that we don't confuse users by echoing
	"echo ERROR:" commands which are not run.

2003-03-14  Richard Dawe  <rich@phekda.freeserve.co.uk>
	    Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (output_texinfo_build_rules, handle_texinfo_helper,
	initialize_per_input):  Add infrastructure for generating HTML
	documentation from texinfo source.
	* lib/am/texinfos.am: Add rules for building HTML documentation
	from texinfo source.
	* lib/am/texibuild.am: Likewise.
	* automake.texi (Texinfo): Document rules for building
	HTML documentation from texinfo source.
	* tests/txinfo21.test: New file.
	* tests/Makefile.am (TESTS): Add txinfo21.test.
	* tests/defs.in: Handle required=makeinfo-html.

2003-04-14  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (%silent_variable_override): New variable.
	(macro_define): Warn about variable definitions overriding
	Automake variables.
	(rule_define): Warn about target definitions overriding
	Automake variables.  Fix $condmsg definition.
	* automake.texi (Invoking Automake): Document the `override'
	category.
	* lib/Automake/ChannelDefs.pm (usage): Likewise.
	* lib/am/texinfos.am [!%?CYGNUS] (MAKEINFO): Do not define,
	this is already done in m4/init.m4.
	* tests/dejagnu2.test: Run $MAKE, don't only grep.  Use
	-Wno-override, and make sure we get a warning without.
	* tests/exeext2.test, tests/substtarg.test: Use -Wno-override,
	and make sure we get a warning without.
	* tests/exeext3.test, tests/java2.test, tests/nolink.test,
	tests/subpkg.test, tests/vartest.test: Use -Wno-override.
	* tests/txinfo13.test: Use installcheck-local instead of overriding
	installcheck.
	* tests/txinfo2.test: Run $MAKE on the real Makefile (this test
	used to succeed thanks to a failure...)
	* tests/location.test: Adjust expected messages.
	* tests/Makefile.am (XFAIL_TESTS): Add txinfo5.test.

2003-04-12  Raja R Harinath  <harinath@acm.org>

	* lib/Automake/DisjConditions.pm (true): Don't cache answer.
	(invert): Update comment.
	(_simplify): Remove.
	(simplify): Implement using invert().
	* lib/Automake/tests/DisjConditions.pl (test_simplify):
	Update to reflect changes.

2003-04-12  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (scan_autoconf_files): Augment the error message
	about AM_INIT_AUTOMAKE not found.
	Suggested by Bruno Haible.

	* lib/Automake/Version.pm: New file.
	* lib/Automake/Makefile.am (dist_perllib_DATA): Add Version.pm.
	* lib/Automake/tests/Version.pl: New file.
	* lib/Automake/tests/Makefile.am (TESTS): Add Version.pl.
	* tests/Makefile.am (TESTS): Remove version5.test.
	* tests/version5.test: Delete.  Move the tests to Version.pl.
	* automake.in (version_split, version_compare, version_check): Move ...
	* lib/Automake/Version.pm (split, compare, check): ... here.

2003-04-11  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/Automake/tests/Condition.pl (test_reduce_and)
	(test_reduce_or): Cosmetics.
	* lib/Automake/tests/DisjConditions.pl (test_sub_conditions):
	Fix a comment.
	* lib/Automake/DisjConditions.pm (sub_conditions): Add missing C<...>
	in comment.
	* tests/yacc8.test, configure.in: Update copyright year.

2003-04-10  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* configure.in: Get the build platform name.  Define
	MODIFICATION_DELAY as the time to wait after modifying a file,
	to cope with timestamp granularity issues, depending
	on the platform.
	* tests/defs.in: Define `sleep' using MODIFICATION_DELAY.

2003-04-10  Eric Siegerman  <eric_97@pobox.com>  (tiny change)

	* automake.texi (Public macros): Clarify that the new
	AM_INIT_AUTOMAKE variant is preferred, and the old one
	deprecated.  Copy-edit the rest of the AM_INIT_AUTOMAKE item.
	(Hello): Caution that the example uses the deprecated
	AC_INIT/AM_INIT_AUTOMAKE syntax, and xref to the discussion.

2003-04-10  Alexandre Duret-Lutz  <adl@gnu.org>

	Retain all variable definitions until the whole Makefile.am has
	been processed, then output all variables in one step, at the top
	of Makefile.in.  (Older revisions used to output user variables
	before generating Automake targets, and to mix Automake variables
	with Automake targets, preventing redefinitions of previously
	output variables.)

	* automake.in (%var_pretty): New variable.
	(VAR_ASIS, VAR_PRETTY): New constants.
	(@var_list): Rename as ...
	(@var_order): ... this.
	(initialize_per_input): Clear %var_pretty.
	(handle_variables): New function, extracted from ...
	(read_main_am_file): ... here.
	(generate_makefile): Call handle_variable after everything else.
	(handle_dist): Use define_pretty_variable, not pretty_print.
	(pretty_print): Delete.
	(macro_define): Augment with $COMMENT and $PRETTY parameters.
	Update %var_comment, %var_pretty, and @var_order.  Adjust callers.
	(variable_pretty_output): Merge with ...
	(variable_output): ... this, and choose the prettiness on a
	per-condition basis.
	(append_comments): Delete.  This work is now done by macro_define.
	(read_am_file, file_contents_internal): Don't call append_comments
	nor update @var_list, adjust calls to macro_define.
	(handle_subdirs): Don't explicitly output RECURSIVE_TARGETS,
	just mark it as VAR_PRETTY.
	* tests/exeext.test: Make sure bin_PROGRAMS is output only once.
	Report from Jim Meyering.

2003-04-06  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (handle_installdirs): Rename as ...
	(handle_install): ... this.  Define maybe_BUILT_SOURCES.
	(generate_makefile): Adjust call to handle_install.
	* lib/am/install.am (install): Use %maybe_BUILT_SOURCES%.
	* automake.texi (Sources, Built sources example): BUILT_SOURCES
	is honored by `make install' too.
	* tests/check3.test: Make sure that `make install' also depends
	upon BUILT_SOURCES.
	Report from Alexander Turbov.

	* lib/am/libs.am (ARFLAGS): Define.
	* automake.in (handle_libraries): Use `$(ARFLAGS)' instead of
	hard-coding `cru'.
	* automake.texi (A Library): Explain how AR, ARFLAGS and RANLIB
	are used, and how they can be overridden.
	(Program and Library Variables): Adjust to show `$(ARFLAGS)'
	instead of `cru'
	* tests/ar.test: Rewrite to test for AR, ARFLAGS, and RANLIB.
	* tests/ranlib.test: Delete, obsoleted by ar.test.
	* tests/Makefile.am (TESTS): Remove ranlib.test.
	Report from Paul Thomas.

2003-04-03  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (check_trailing_slash): New function (variation on
	a patch by Peter Muir).  Diagnose whitespaces following trailing
	backslash.
	(read_am_file): Use it.
	* tests/backsl4.test: New file.
	* tests/Makefile.am (TESTS): Add backsl4.test.
	Reported by Peter Muir.

2003-03-29  Raja R Harinath  <harinath@acm.org>

	Speedup Automake::DisjConditions::invert().
	* lib/Automake/Condition.pm (multiply): New.
	* lib/Automake/DisjConditions.pm (_multiply): Use it.
	(sub_conditions): Likewise.

	* lib/Automake/Condition.pm (reduce): Rename to ...
	(reduce_and): ... this.
	(reduce_or): New.
	* lib/Automake/DisjConditions.pm (_multiply): Use reduce_or().
	* lib/Automake/tests/Condition.pl (test_reduce): Rename to ...
	(test_reduce_and): ... this.
	(test_reduce_or): New.
	* lib/Automake/tests/DisjConditions.pl
	(test_invert): Update to reflect effect of reduce_or().
	(test_simplify): Don't skip invert() on larger inputs.

2003-03-29  Raja R Harinath  <harinath@cs.umn.edu>

	* tests/yacc8.test: Add a $sleep before modifying Makefile.am so
	that timestamp will change.

2003-03-23  Akim Demaille  <akim@epita.fr>
	    Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/tags.am (TAGS): Use --etags-include instead of --include,
	when supported by etags (Exuberant Ctags).
	* tests/tagsub.test: Rewrite to _run_ the `tags' rule.

2003-03-20  Alexandre Duret-Lutz  <adl@gnu.org>

	For Debian Bug #185388:
	* automake.texi (Extending): Augment the install-exec-hook
	discussion with an example how to symlink a versioned binary.
	* tests/insthook.test: Rewrite to test the above example.
	Report from James R. Van Zandt.

2003-03-19  Alexandre Duret-Lutz  <adl@gnu.org>

	* Makefile.am (maintainer-check): Allow `automake:' tokens,
	occuring in location.test.  Automake now has 5 legitimate
	unsubstituted @strings@.

	* tests/aclocal4.test: Require GNU make.

2003-03-14  Alexandre Duret-Lutz  <adl@gnu.org>

	* tests/aclocal4.test: New file.  Test for the ACLOCAL_M4 bug below.
	* tests/Makefile.am (TESTS): Add aclocal4.test.

2003-03-14  Jim Meyering  <jim@meyering.net>

	* automake.in (scan_aclocal_m4): Define ACLOCAL_M4 even in
	subdirectories.  Makefile.in depends on that variable.

2003-03-13  Alexandre Duret-Lutz  <adl@gnu.org>

	* m4/init.m4: Remove a leftover comment from the pre-1.7 era.

	Fix for PR automake/386:
	* m4/init.m4: Require Autoconf 2.55.
	Reported by Owen Taylor.

	* lib/am/depend2.am (?GENERIC?%EXT%.o, ?GENERIC?%EXT%.obj)
	(?GENERIC?%EXT%.lo): Use `mv -f' instead of `mv' in FASTDEP mode.
	Suggested by Matthias Andree.

	* tests/README: Typo.

2003-03-08  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/depend2.am (?GENERIC?%EXT%.o, ?GENERIC?%EXT%.obj)
	(?GENERIC?%EXT%.lo): Hide the if/then/else machinery for FASTDEP.
	Just echo the gcc command.
	Suggested by Karl Berry.

2003-03-06  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/depend2.am (?GENERIC?%EXT%.lo): Do not use
	`test -f foo || echo $(srcdir)/` to emulate a VPATH search when
	outputing suffix rules.  This follows 2003-02-25's change.
	* lib/am/lex.am (?GENERIC?%EXT%%DERIVED-EXT%): Likewise.
	* lib/am/yacc.am (?GENERIC?%EXT%%DERIVED-EXT%): Likewise.

2003-03-05  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.texi (Requirements) <AC_CONFIG_FILES>: Files listed
	with AC_CONFIG_FILES are cleaned by `make distclean'.  Don't
	pretend otherwise.
	Reported by Rafael Laboissiere.

2003-03-04  Andreas Buening  <andreas.buening@nexgo.de>

	* lib/mdate-sh: Find out which column of the ls -l output contains
	the month. Do not assume it is at least the fifth column.

2003-02-26  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.texi (Emacs Lisp): Mention that `dist_' can be used.

	* automake.texi (Emacs Lisp): Instruct people to use lisp_DATA
	instead of lisp_LISP when they don't want byte-compilation.
	Don't mention ELCFILES anymore.
	* automake.in (handle_data): Allow lisp_DATA.
	* tests/lisp5.test: New file.
	* tests/Makefile.am (TESTS): Add lisp5.test.

	* automake.in (handle_emacs_lisp): Don't build *.elc files
	if ELCFILES was set empty.
	* tests/lisp4.test: New file.
	* tests/Makefile.am (TESTS): Add lisp4.test.
	Reported by Simon Josefsson.

	* tests/lex3.test, tests/lex5.test: Require flex.
	Reported by Leo Davis.

2003-02-25  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/depend2.am (?GENERIC?%EXT%.o, ?GENERIC?%EXT%.obj): Do not
	use the `test -f foo || echo $(srcdir)/` to emulate a VPATH search
	when outputing suffix rules.
	* lib/am/texibuild.am (?GENERIC?%SOURCE_SUFFIX%.dvi)
	(?GENERIC?%SOURCE_SUFFIX%.pdf): Likewise.
	Suggested by Bruno Haible.

	* automake.in (read_am_file): Catch trailing backslashes on last line.
	* tests/backsl3.test: New file.
	* tests/Makefile.am (TESTS): Add backsl3.test.
	Reported by Akim Demaille.

2003-02-24  Alexandre Duret-Lutz  <adl@gnu.org>

	* ChangeLog: Move 2002's entries to ...
	* ChangeLog.02: ... this new file.
	* Makefile.am (EXTRA_DIST): Add ChangeLog.02.

2003-02-24  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* tests/version7.test: Use $sleep to sleep before updating
	the version, to work around timestamp inconsistencies in Windows.

2003-02-24  Bruno Haible  <bruno@clisp.org>
	    Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/texibuild.am: Don't remove the target info files. Instead,
	back up and restore them if makeinfo fails.
	* tests/txinfo20.test: New file.
	* tests/Makefile.am (TESTS): Add txinfo20.test.

2003-02-23  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.texi (FAQ, CVS, maintainer-mode, wildcards)
	(distcleancheck): Fix typos and other errors reported by Karl
	Berry.

2003-02-20  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/texibuild.am (%SOURCE_SUFFIX%%DEST_SUFFIX%): Use $(...)
	instead of ${...}.

	* tests/defs.in: Handle required=ro-dir.
	* tests/destdir.test: Use this.

2003-02-19  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* lib/am/distdir.am (distcheck): Strip any leading DOS drive
	from dc_install_base.

2003-02-19  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/texinfos.am (install-info-am, uninstall-info-am): Install
	DJGPP-style *.iNN info files.
	(maintainer-clean-aminfo): Rewrite using the same pattern
	as in uninstall-info-am.
	* lib/am/texibuild.am (%SOURCE_SUFFIX%%DEST_SUFFIX%): Erase
	DJGPP-style *.iNN info files before running $(MAKEINFO).
	* tests/txinfo19.test: New file.
	* tests/Makefile.am (TESTS): Add txinfo19.test.

2003-02-18  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* lib/depcomp (dashmstdout): Cope with DOS filenames in
	dependencies.

2003-02-17  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/depcomp (makedepend): Don't pass $object to makedepend.
	Reported by Stepan Kasal.

2003-02-12  Alexandre Duret-Lutz  <adl@gnu.org>

	* tests/defs.in: Handle required=makedepend.

	* Makefile.am (maintainer-check): Update the diff check
	to account for the recent @SHELL@ substitution.

2003-02-11  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/depcomp: Do not put comments on the `icc)' line.

	* lib/config.guess, lib/config.sub, lib/texinfo.tex: New upstream
	versions.

	Fix for PR automake/381:
	* automake.in (handle_gettext): Do not print diagnostics
	about po/ and intl/ missing from SUBDIRS if po/ does not
	exist.  Warn if `SUBDIRS = intl' is used although libintl
	is 'external'.
	* tests/gettext.test: Make sure diagnostics are not output
	when po/ does not exist.
	* tests/gettext2.test: Test for unwanted intl/.
	PR from Alexander Turbov, fix suggested by Bruno Haible.

	* m4/depend.m4: Grep depcomp's stderr for icc warnings about
	ignored options.
	* lib/depcomp (icc): New mode.
	* tests/depcomp5.test: New file.
	* tests/defs.in: Handle required=icc.
	* tests/Makefile.am (TESTS): Add it.

	Temporary hack for PR automake/381:
	* automake.in (handle_gettext): Turn missing po/ and intl/ errors
	into -Wsyntax warnings.

2003-02-10  Richard Dawe  <rich@phekda.freeserve.co.uk>

	* Makefile.am: Substitute @SHELL@ in automake.in and aclocal.in.
	This makes the setting of SHELL work for DJGPP.

2003-02-10  Alexandre Duret-Lutz  <adl@gnu.org>

	For PR automake/385:
	* lib/depcomp (makedepend): Strip any libtool call, before
	running makedepends.
	* tests/depcomp4.test: New file.
	* tests/Makefile.am (TESTS): Add it.
	Reported by Jeff Squyres.

	Related to PR automake/385:
	* lib/depcomp (dashmstdout): Do not use `-o /dev/null', or gcc will
	write dependencies to /dev/null.  `-o /dev/null' was added
	on 2002-06-13 just because I tried to replace `-o foo.o' by something
	else and didn't thought about removing it entirely.
	* tests/depcomp3.test: New file.
	* tests/Makefile.am (TESTS): Add it.

	* automake.in (BEGIN): Override $ENV{'SHELL'} with ./configure's
	SHELL for DJGPP.
	Suggested by Richard Dawe.

2003-02-09  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.texi (FAQ, CVS, maintainer-mode, wildcards)
	(distcleancheck): New nodes.

2003-02-06  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (scan_autoconf_files): Don't complain that
	AM_INIT_AUTOMAKE comes from an old version if it was not found.

2003-02-05  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (am_install_var): Simplify filtering of
	variable_loc_and_value_as_list_recursive's output.

2003-02-04  Alexandre Duret-Lutz  <adl@gnu.org>

	* m4/init.m4 (_AC_AM_CONFIG_HEADER_HOOK): Recompute
	indexes of header files so we create stamp files with
	the right numbers when config.status is run on some headers.
	* tests/stamph2.test: Check for this.
	Reported by Sander Niemeijer.

2003-02-02  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (vars_scanned): Move near traverse_variable_recursively.
	(traverse_variable_recursively,
	traverse_variable_recursively_worker): Accept a $COND_FILTER argument
	to filter out conditions during recursion.  Don't recurse into
	undefined variables.  Don't pass empty results to &FUN_COLLECT.
	(value_to_list): Remove, was used by
	variable_value_as_list_recursive_worker only.
	(variable_value_as_list_recursive_worker): Rewrite using
	traverse_variable_recursively.  Remove the $parent argument.
	(variable_value_as_list_recursive,
	variable_loc_and_value_as_list_recursive): Adjust calls
	to variable_value_as_list_recursive_worker.  Don't reset
	%vars_scanned.
	* tests/cond3.test: Don't expect empty helper variables,
	we don't output them anymore.
	* tests/cond30.test: Use an undefined variable.

	* automake.in (handle_programs): Strip $(EXEEXT) before
	calling &check_canonical_spelling.
	* tests/exeext.test: Make sure we don't use a
	maude3__EXEEXT__OBJECTS variable.

2003-02-02  Jeremy Nimmer  <jwnimmer@alum.mit.edu>  (tiny change)

	For Debian Bug #39542:
	* automake.texi (Invoking Automake, Optional): Document how
	AC_CONFIG_AUX_DIR interacts with missing files.

2003-02-02  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/Automake/DisjConditions.pm (_permutations_worker)
	(permutations): Remove, so that people aren't tempted to use it.
	* lib/Automake/tests/DisjConditions.pl (tests_permutations): Remove.

	* automake.in (variable_conditions_recursive): Remove.
	(variable_conditionally_defined): Rewrite using
	traverse_variable_recursively.

	* automake.in (traverse_variable_recursively,
	traverse_variable_recursively_worker): Pass one merged Condition
	instead of a stack of conditions to &FUN_STORE and &FUN_COLLECT.
	(transform_variable_recursively, define_objects_from_sources)
	(handle_lib_objects, variable_conditions_recursive): Adjust usage.

2003-02-01  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (handle_lib_objects): Compute _DEPENDENCIES variables
	using transform_variable_recursively instead of
	variable_conditions_recursive and variable_value_as_list_recursive
	to avoid combinatorial explosion.
	(handle_lib_objects_cond): Merge into handle_lib_objects.
	* tests/cond11.test: Don't grep internal details in Makefile.in,
	run $MAKE to make sure the resulting Makefile runs as expected.
	* tests/cond29.test: Also exercise conditional _LDADD.
	* tests/cond31.test, tests/cond32.test: New files.
	* tests/Makefile.am (TESTS): Add tests/cond31.test and
	tests/cond32.test.

2003-01-31  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (handle_lib_objects_cond): Ignore -dlopen and
	-dlpreopen in _LIBADD variables too.
	(handle_LIBOBJS, handle_ALLOCA): New functions, extracted from
	handle_lib_objects_cond.
	* tests/libtool7.test: New file.
	* tests/Makefile.am (TESTS): Add libtool7.test.

	* automake.texi (Program and Library Variables): Clarify that
	_LIBADD is for libraries and _LDADD for programs.

	* automake.in (handle_source_transform): Correct typo from 2003-01-23.

2003-01-28  Alexandre Duret-Lutz  <adl@gnu.org>

	Fix for PR automake/352:
	* automake.in (transform_variable_recursively): If the destination
	and the source variables are the same, delete the source variable
	before defining the destination variable.
	(handle_programs): Strip any $(EXEEXT) suffix from $one_file,
	or this will confuse handle_source_transform.
	(append_exeext): Rewrite using transform_variable_recursively.
	* tests/cond29.test, tests/cond30.test: New files.
	* tests/exeext.test: Run ./configure and make, this uncovered
	the above handle_programs issue.
	* tests/Makefile.am (TESTS): Add cond29.test and cond20.test.

	* automake.in (%subobjvar): Replace by ...
	(%gen_varname): ... this.
	(subobjname): Replace by ...
	(gen_varname): ... this.
	(initialize_per_input): Clean gen_varname instead of subobjname.
	(transform_variable_recursively): New function, extracted
	from define_objects_from_sources.
	(define_objects_from_sources): Use transform_variable_recursively.
	Remove the unused $parent argument.
	(handle_source_transform): Adjust call to define_objects_from_sources.

2003-01-23  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (@substfroms, @substtos): Move near
	traverse_variable_recursively.
	(traverse_variable_recursively, traverse_variable_recursively_worker):
	New functions, extracted from define_objects_from_sources.
	(define_objects_from_sources): Rewrite using
	traverse_variable_recursively.
	(handle_source_transform): Use variables_conditionally_defined
	instead of calling variable_conditions_recursive directly.
	Adjust the call to define_objects_from_sources; there is no need
	to reset @substtos, @substfroms, and %vars_scanned now.
	(variable_conditions_recursive): Rewrite using
	traverse_variable_recursively.
	(variable_conditions_recursive_sub): Remove.
	(variable_conditionally_defined): Fix condition comparison (the
	consequence was that DIST_SUBDIRS was always output).
	* lib/Automake/Condition.pm (merge): Allow merging several
	conditions at once.

2003-01-22  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.texi (Python): Explain that directory variables start
	with either ${prefix} or ${exec_prefix}, and point to the
	`Installation Directory Variables' section of the Autoconf manual.

2003-01-21  Alexandre Duret-Lutz  <adl@gnu.org>

	* lib/am/distdir.am (top_distdir, distdir): Define these
	variables only in top level Makefile.  Redefine $(top_distdir)
	as $(distdir).
	(distdir): Fix passing of $(top_distdir) to sub-makes.
	* automake.in (handle_dist): Do not define the DISTDIR and
	TOP_DISTDIR transformations.  We don't need them anymore.
	* automake.texi (Dist): Reorder the dist-hook section, and move
	the DIST_SUBDIRS paragraph earlier.  Document distdir and
	top_distdir.
	* tests/subpkg.test: Update to check for $(distdir) and
	$(top_distdir).

2003-01-19  Alexandre Duret-Lutz  <adl@gnu.org>

	Rename more files to accomodate 8+3 file systems, and adjust the
	vocabulary at the same time: AM_CONDITIONAL defines "conditionals",
	and we call "condition" a conjunction of "conditionals".
	* lib/am/Conditional.pm: Rename to lib/am/Condition.pm.
	* lib/am/tests/Conditional.pl: Rename to lib/am/tests/Condition.pl.
	* lib/am/ConditionalSet.pm: Rename to lib/am/DisjConditions.pm.
	* lib/am/tests/ConditionalSet.pl: Rename to
	lib/am/tests/DisjConditions.pl
	* lib/am/Conditional.pm (condition_negate): Rename to ...
	* lib/am/Condition.pm (conditional_negate): ... this.
	* automake.in: Adjust references to Condition and DisjConditions.
	(check_ambiguous_conditional, conditional_ambiguous_p): Rename to ...
	(check_ambiguous_condition, condition_ambiguous_p): ... these.

	* tests/README: New file.

	* automake.texi (Conditional Programs): Show a sample Makefile.am.
	Remind $(EXEEXT) must be appended to configure substitutions.
	Show how Automake conditionals can be used instead.
	* tests/exeext.test (check_PROGRAMS): Make sure EXEEXT is also
	appended to conditionally defined programs.

2003-01-16  Jim Meyering  <jim@meyering.net>

	Accept --help and --version, and lots of syntactic clean-up.
	* lib/install-sh: Use consistent indentation, two spaces per level.
	(scriptversion): New variable.
	Change initializations like `variable=""' to `variable='.
	(usage): New variable.
	Use `test', not `['.
	Use `test -z "$var"', not `[ x"$var" = x ]'.
	Use `test -n "$var"', not `[ x"$var" != x ]'.
	Alphabetize case entries.
	Accept --help and --version options.
	Remove unnecessary `else :' clauses.
	Add a `Local variables' eval block to help emacs users update
	the time-stamp variable added above.
	Mostly from Karl Berry.

2003-01-16  Alexandre Duret-Lutz  <adl@gnu.org>

	* m4/python.m4 (AM_PATH_PYTHON) <_AM_PYTHON_INTERPRETER_LIST>: Add
	python2.3.

	* m4/python.m4 (AM_PATH_PYTHON): Query distutils for `pythondir'
	or `pyexecdir', for the sake of 64-bit distributions that usually
	use lib64/ instead of lib/.  Fall back to the default directory
	if it doesn't work.
	Suggested by Gwenole Beauchesne.

2003-01-14  Alexandre Duret-Lutz  <adl@gnu.org>

	For PR automake/382:
	* automake.texi (Yacc and Lex): Document `AM_YFLAGS = -d'.
	Explain BUILT_SOURCES is usually needed in this case.
	Reported by William S Fulton.

2003-01-13  Alexandre Duret-Lutz  <adl@gnu.org>

	Rename some files for the sake of 8+3 file systems.
	* tests/aclocali.test:     Rename to tests/aclocal.test.
	* tests/aclocali1.test:    Rename to tests/aclocal2.test.
	* tests/aclocalii.test:    Rename to tests/aclocal3.test.
	* tests/acoutput.test:     Rename to tests/acoutpt.test.
	* tests/acoutput2.test:    Rename to tests/acoutpt2.test.
	* tests/acouttbs.test:     Rename to tests/acoutbs.test.
	* tests/acouttbs2.test:    Rename to tests/acoutbs2.test.
	* tests/autoheader.test:   Rename to tests/autohdr.test.
	* tests/autoheader2.test:  Rename to tests/autohdr2.test.
	* tests/condincl.test:     Rename to tests/condinc.test.
	* tests/condincl2.test:    Rename to tests/condinc2.test.
	* tests/distcommon.test:   Rename to tests/distcom.test.
	* tests/distcommon2.test:  Rename to tests/distcom2.test.
	* tests/distcommon3.test:  Rename to tests/distcom3.test.
	* tests/installsh.test:    Rename to tests/instsh.test.
	* tests/installsh2.test:   Rename to tests/instsh2.test.
	* tests/instdata.test:     Rename to tests/instdat.test.
	* tests/instdata2.test:    Rename to tests/instdat2.test.
	* tests/libobj12b.test:    Rename to tests/libobj13.test.
	* tests/link_f_c.test:     Rename to tests/link_fc.test.
	* tests/link_f_c_cxx.test: Rename to tests/link_fccxx.test.
	* tests/link_f_cxx.test:   Rename to tests/link_fcxx.test.
	* tests/nodefine.test:     Rename to tests/nodef.test.
	* tests/nodefine2.test:    Rename to tests/nodef2.test.
	* tests/required.test:     Rename to tests/reqd.test.
	* tests/required2.test:    Rename to tests/reqd2.test.
	* tests/sourcesub.test:    Rename to tests/srcsub.test.
	* tests/sourcesub2.test:   Rename to tests/srcsub2.test.
	* tests/specflags.test:    Rename to tests/specflg.test.
	* tests/specflags2.test:   Rename to tests/specflg2.test.
	* tests/specflags3.test:   Rename to tests/specflg3.test.
	* tests/specflags6.test:   Rename to tests/specflg6.test.
	* tests/specflags7.test:   Rename to tests/specflg7.test.
	* tests/specflags8.test:   Rename to tests/specflg8.test.
	* tests/specflags9.test:   Rename to tests/specflg9.test.
	* tests/subdircond.test:   Rename to tests/subcond.test.
	* tests/subdircond2.test:  Rename to tests/subcond2.test.
	* tests/subdircond3.test:  Rename to tests/subcond3.test.
	* tests/texinfo.test:      Rename to tests/txinfo.test.
	* tests/texinfo2.test:     Rename to tests/txinfo2.test.
	* tests/texinfo3.test:     Rename to tests/txinfo3.test.
	* tests/texinfo4.test:     Rename to tests/txinfo4.test.
	* tests/texinfo5.test:     Rename to tests/txinfo5.test.
	* tests/texinfo6.test:     Rename to tests/txinfo6.test.
	* tests/texinfo7.test:     Rename to tests/txinfo7.test.
	* tests/texinfo8.test:     Rename to tests/txinfo8.test.
	* tests/texinfo9.test:     Rename to tests/txinfo9.test.
	* tests/texinfo10.test:    Rename to tests/txinfo10.test.
	* tests/texinfo13.test:    Rename to tests/txinfo13.test.
	* tests/texinfo16.test:    Rename to tests/txinfo16.test.
	* tests/texinfo17.test:    Rename to tests/txinfo17.test.
	* tests/texinfo18.test:    Rename to tests/txinfo18.test.
	* tests/Makefile.am (TESTS): Adjust.
	* ChangeLog.1996: Rename to ChangeLog.96.
	* ChangeLog.1998: Rename to ChangeLog.98.
	* ChangeLog.2000: Rename to ChangeLog.00.
	* ChangeLog.2001: Rename to ChangeLog.01.
	* Makefile.am (EXTRA_DIST): Adjust.
	Reported by Richard Dawe.

2003-01-13  Richard Dawe  <rich@phekda.freeserve.co.uk>  (tiny change)

	* lib/am/distdir.am (distcheck): '=' is not valid in DOS filenames.
	Use '_build' and '_inst' instead of '=build' and '=inst'.
	* tests/man2.test: Reflect change automake: check for files in
	'_build' and '_inst' directories instead of '=build' and '=inst'.

2003-01-13  Alexandre Duret-Lutz  <adl@gnu.org>

	Use `_dirstamp' when the file-system doesn't support `.dirstamp'.
	* m4/lead-dot.m4: New file.
	* m4/Makefile.am (dist_m4data_DATA): Add lead-dot.m4
	* m4/init.m4 (AM_INIT_AUTOMAKE): Require AM_SET_LEADING_DOT.:
	* m4/depend.m4 (AM_SET_DEPDIR): Require AM_SET_LEADING_DOT. Define
	DEPDIR using am__leading_dot.
	* automake.in (require_build_directory): Define am__dirstamp, a new
	variable for the dirstamp basename, based on am__leading_dot.
	* tests/subobj6.test: Move all `test -f' into Makefiles, so we can
	use $(am__dirstamp).
	Reported by Richard Dawe.

	* tests/gnits2.test, tests/pr300-prog.test, tests/transform.test:
	Move all `test -f' into Makefiles, so we can honor $(EXEEXT) when
	testing for programs.
	Reported by Richard Dawe.

2003-01-10  Alexandre Duret-Lutz  <adl@gnu.org>

	* Makefile.am (maintainer-check): Suggest using $sleep instead of
	sleep 2.
	* tests/defs.in (sleep): New variable.
	* tests/asm.test, tests/confsub.test, tests/lisp3.test,
	tests/texinfo16.test, tests/warnopts.test, tests/yaccvpath.test:
	Use $sleep instead of sleep 2, to work around timestamp
	inconsistencies in Windows.
	Reported by Richard Dawe.

	* Makefile.am (maintainer-check): Do not require SHELL=/bin/sh
	after $MAKE -e.
	* tests/ansi3.test, tests/ansi5.test, tests/cond22.test,
	tests/man2.test, tests/subobj3.test, tests/suffix8.test,
	tests/suffix11.test: Do not set SHELL=/bin/sh after $MAKE -e.
	$SHELL is overridden by tests/defs, so it won't hurt even
	if $MAKE -e uses the $SHELL envvar.
	* tests/ansi.test, tests/insh2.test, tests/texinfo.test,
	tests/texinfo8.test: Use SHELL=$SHELL, not SHELL=/bin/sh.
	Reported by Richard Dawe.

	Build elisp files all at once instead of one by one.
	* automake.in (handle_emacs_lisp): Define am__ELFILES.  Add
	elc-stamp to all's dependencies.
	* lib/am/lisp.am (elc-stamp): New rule, build all *.elc files.
	(.el.elc): Rewrite to call elc-stamp if $@ doesn't exist.
	(clean-lisp): Clean elc-stamp.
	* lib/elisp-comp: Reindent.  Erase the temporatry directory
	from a trap.  Propagate Emacs's exit status.
	* tests/lisp3.test: New file.
	* tests/Makefile.am (TESTS): Add lisp3.test.
	Reported by Ryan T. Sammartino.

2003-01-09  Akim Demaille  <akim@epita.fr>

	* automake.texi: Prefer $(FOO) to @FOO@ in the documentation.

2003-01-08  Alexandre Duret-Lutz  <adl@gnu.org>

	* m4/lispdir.m4: Register EMACS and EMACSLOADPATH as precious
	variables.  Suggested by Ryan T. Sammartino.

2003-01-05  Alexandre Duret-Lutz  <adl@gnu.org>

	* automake.in (macro_define): Add missing `{$cond}' (typo from
	2002-09-18).
	($gen_copyright): Append year 2003.
	(version): Increase year.

	* tests/defs.in: Substitute aclocaldir instead of running
	the installed aclocal.  Otherwise Libtool and Gettext
	tests get skipped when aclocal doesn't preexist.
	Reported by Imacat.
	* tests/listval.test, tests/suffix2.test: Remove pointless -I
	argument to aclocal.

-----

Copyright (C) 2003  Free Software Foundation, Inc.

This file is part of GNU Automake.

GNU Automake is free software; you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation; either version 2, or (at your option)
any later version.

GNU Automake is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with autoconf; see the file COPYING.  If not, write to
the Free Software Foundation, Inc., 59 Temple Place - Suite 330,
Boston, MA 02111-1307, USA.
