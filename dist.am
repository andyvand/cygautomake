dist: $(DIST_FILES) distname
	rm -rf `cat distname`; mkdir `cat distname`
	@for file in $(DIST_FILES); do \
	  echo linking $$file; \
	  ln $(srcdir)/$$file `cat distname` || \
	    { echo copying $$file instead; cp -p $(srcdir)/$$file `cat distname`;}; \
	done
	if test -n "$(SUBDIRS)"; then \
	for subdir in $(SUBDIRS); do \
	  (cd $$subdir; $(MAKE) subdir=$$subdir $@); done; \
	fi
	chmod -R a+r `cat distname`
	tar -chozf `cat distname`.tar.gz `cat distname`
	rm -rf `cat distname` distname

