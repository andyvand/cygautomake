#! /bin/sh

# Automake --help, and --version should have priority over any other option
# so that their `exit 0' is coherent.

. $srcdir/defs || exit 1

set -e

# This is expected to fail ...
$AUTOMAKE -Wnonexistant 2>stderr && exit 1
cat stderr
grep ':.*nonexistant' stderr

# ... but this should not.
$AUTOMAKE -Wnonexistant --help 2>stderr
cat stderr
grep ':.*nonexistant' stderr && exit 1


# Similarly, this should fail ...
$AUTOMAKE --nonexistant 2>stderr && exit 1
cat stderr
grep ':.*nonexistant' stderr

# ... but this should not.
$AUTOMAKE --nonexistant --help 2>stderr
cat stderr
grep ':.*nonexistant' stderr && exit 1

:
