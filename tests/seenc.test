#! /bin/sh

# Test to make sure C-but-not-CC error works.

. $srcdir/defs || exit 1

cat >> configure.in << 'END'
dnl AC_PROG_CC and AC_PROG_CXX missing on purpose
AC_LIBOBJ([fsusage])
AC_LIBOBJ([mountlist])
END

cat > Makefile.am << 'END'
bin_PROGRAMS = foo
foo_SOURCES = x.C
foo_LDADD = @LIBOBJS@
END

: > fsusage.c
: > mountlist.c

$ACLOCAL || exit 1
# Use -Wno-error, because there are many error messages
# output for this test, and we just want to make sure some of
# them are about CC and CXX being undefined.
$AUTOMAKE --Wno-error 2> err && exit 1
$FGREP CC err || exit 1
$FGREP CXX err || exit 1
